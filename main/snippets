
import sys
from tika import parser


def parse_file(fname):
    """Read and assign file content"""
    try:
        f = parser.from_file(fname, xmlContent=True)
    except FileNotFoundError:
        print("\nFile {} not found.\n".format(fname))
        sys.exit()

    # Split file content:
    plist = []
    ptext = {}
    strlength = len('<div class="page">')
    fcontent = f['content']

    for index, text in enumerate(fcontent):
        if fcontent[index:index+strlength] == '<div class="page">':
            plist.append(index)
            print(index, text)
        else:
            pass

    if plist:
        ptext.update({'header': fcontent[0:plist[0]]})
        if len(plist) > 1:
            if int(f['metadata']['xmpTPg:NPages']) == len(plist):
                pcounter = 1
                for i in range(1, len(plist), 1):
                    print(i)
                    ptext.update({'page'+str(pcounter): fcontent[plist[i-1]:plist[i]]})
                    pcounter += 1
                ptext.update({'page'+str(pcounter): fcontent[plist[i]:]})
            else:
                print("\nError reading file {}.\n".format(fname))
                sys.exit()
    return ptext



# Compare files:
def compare_content(pdictlist):
    """Compare content of two files"""
    if pdictlist[0].keys() == pdictlist[1].keys():
        print('comparing files...')
    else:
        pass



def main():

    filename1 = '1.pdf'
    filename2 = '2.pdf'


    # Read element variable output from .dat file:
    pagetext1 = parse_file(filename1)
    pagetext2 = parse_file(filename2)
    
    pagedictlist = [pagetext1, pagetext2]

    compare_content(pagedictlist)

    print(set(pagetext1.items()) ^ set(pagetext2.items()))


